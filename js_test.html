<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .custom-select {
            position: relative;
            display: inline-block;
        }
    
        .select-options {
            list-style: none;
            padding: 0;
            margin: 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            overflow-y: auto;
            max-height: 200px;
            width: 200px;
        }
    
        .select-options li {
            padding: 5px 10px;
        }
    
        .select-options li a {
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-decoration: none;
            color: #333;
        }
    
        .option-price {
            font-size: 12px;
            color: #999;
        }
    
        .select-options li:hover {
            background-color: #f0f0f0;
        }
    
        .selected-options {
            list-style: none;
            padding: 0;
            margin: 10px 0 0;
        }
    
        .selected-options li {
            margin-bottom: 5px;
            font-weight: bold;
        }
    
        </style>
    </head>
    <body>
        <div class="custom-select">
        <ul id="mySelect" class="select-options" multiple>
            <!-- <li><a href="#" data-value="option1">사과<span class="option-price">$10</span></a></li>
            <li><a href="#" data-value="option2">바나나<span class="option-price">$15</span></a></li>
            <li><a href="#" data-value="option3">복숭아<span class="option-price">$20</span></a></li>
            <li><a href="#" data-value="option4">아보카도<span class="option-price">$25</span></a></li>       -->
            <li><a href="#" data-value="option1">[픽어베이글] 플레인 베이글<span class="option-price">2900</span></a></li>
            <li><a href="#" data-value="option2">[픽어베이글] 통밀 베이글<span class="option-price">2900</span></a></li>
            <li><a href="#" data-value="option3">[픽어베이글] 블루베리 베이글<span class="option-price">2900</span></a></li>
            <li><a href="#" data-value="option4">[픽어베이글] 시나몬 앤 레이즌 베이글<span class="option-price">2900</span></a></li>
            <li><a href="#" data-value="option5">[픽어베이글] 에브리띵 베이글<span class="option-price">2900</span></a></li>
            <li><a href="#" data-value="option6">[픽어베이글] 멀티 그레인 베이글<span class="option-price">2800</span></a></li>
            <li><a href="#" data-value="option7">[픽어베이글] 세서미 베이글<span class="option-price">2800</span></a></li>
            <li><a href="#" data-value="option8">[픽어베이글] 다크통밀 베이글<span class="option-price">2900</span></a></li>
        </ul>
        </div>
        
        <ul id="selectedOptions" class="selected-options"></ul>
        
        <div id="totalPrice"></div>
        
    <script>
    
        // 선택된 옵션들의 목록을 저장할 변수입니다.
        const selectOptions = document.querySelectorAll('.select-options li a');
    
        // 선택된 옵션들이 표시될 컨테이너 요소입니다.
        const selectedOptionsContainer = document.getElementById('selectedOptions');
    
        // 각각의 옵션 요소에 클릭 이벤트를 추가합니다.
        selectOptions.forEach(option => {
            option.addEventListener('click', toggleOptionAndUpdateTotalPrice);
        });
    
        // 옵션을 선택 또는 선택 해제할 때 호출되는 함수입니다.
        function toggleOptionAndUpdateTotalPrice(e) {
            e.preventDefault();
    
            // 클릭된 옵션의 값을 가져옵니다.
            const selectedOptionValue = e.target.getAttribute('data-value');
    
            // 클릭된 옵션의 텍스트 내용을 가져옵니다.
            const selectedOptionText = e.target.textContent;
    
            // 클릭된 옵션의 가격을 가져옵니다.
            const selectedOptionPriceElement = e.target.querySelector('.option-price');
            if (selectedOptionPriceElement) {
            // 가격을 숫자로 추출합니다.
            const selectedOptionPriceText = selectedOptionPriceElement.textContent.trim();
            const selectedOptionPrice = parseInt(selectedOptionPriceText.replace(/\D/g, ''), 10);
            
            // 이하 생략하지 않고 코드를 작성합니다.
            if (e.target.classList.contains('selected')) {
                alert('이미 선택된 옵션입니다.');
            } else {
                e.target.classList.add('selected');
                addSelectedOption(selectedOptionValue, selectedOptionText, selectedOptionPrice);
            }
            updateTotalPrice();
            }
    
        }
    
        // 선택된 옵션을 목록에 추가하는 함수입니다.
        function addSelectedOption(value, text, price) {
            // 새로운 선택된 옵션 요소를 생성합니다.
            const selectedOptionElement = document.createElement('li');
            // 선택된 옵션의 텍스트를 요소에 설정합니다.
            // selectedOptionElement.textContent = `${text}`;
            selectedOptionElement.textContent = text.trim().replace(/\s*\[\S+\]\s*/, '');

            // 선택 해제 버튼을 생성합니다.
            const deselectButton = document.createElement('button');
            deselectButton.textContent = '선택 해제';
            deselectButton.classList.add('deselect-button');
            deselectButton.addEventListener('click', function() {
            // 선택 해제 버튼 클릭 시 해당 옵션을 선택 해제합니다.
            selectedOptionElement.remove();
            const correspondingOption = document.querySelector(`.select-options li a[data-value="${value}"]`);
            correspondingOption.classList.remove('selected');
            updateTotalPrice();
            });
    
            // 수량을 담는 input 요소를 생성합니다.
            const quantityInput = document.createElement('input');
            quantityInput.classList.add('quantity-control');
            quantityInput.type = 'number';
            quantityInput.value = 1;
            quantityInput.min = 1;
            quantityInput.addEventListener('input', updateTotalPrice); // input 이벤트를 통해 총 가격 업데이트
    
            // 수량 조절 버튼을 생성합니다.
            const plus = document.createElement('span');
            plus.classList.add('plus');
            plus.innerHTML = '+';
            plus.addEventListener('click', increaseQuantity); // 플러스 버튼에 클릭 이벤트를 추가합니다.
    
            // 마이너스 버튼을 생성합니다.
            const minus = document.createElement('span');
            minus.classList.add('minus');
            minus.innerHTML = '-';
            minus.addEventListener('click', decreaseQuantity); // 마이너스 버튼에 클릭 이벤트를 추가합니다.
    
            // 선택된 옵션과 수량 관련 요소들을 선택된 옵션 컨테이너에 추가합니다.
            selectedOptionElement.appendChild(deselectButton);
            selectedOptionElement.appendChild(minus);
            selectedOptionElement.appendChild(quantityInput);
            selectedOptionElement.appendChild(plus);
            selectedOptionsContainer.appendChild(selectedOptionElement);
        }
    
        // 총 가격 업데이트 함수
        function updateTotalPrice() {
            let totalPrice = 0;
            const selectedOptions = document.querySelectorAll('#selectedOptions li');
            selectedOptions.forEach(option => {
            const priceText = option.textContent.match(/\d+/); // 옵션의 가격을 정규식을 통해 추출합니다.
            if (priceText) {
                const price = parseInt(priceText[0], 10); // 가격을 숫자로 변환합니다.
                const quantity = parseInt(option.querySelector('.quantity-control').value, 10);
                totalPrice += price * quantity; // 총 가격 계산
            }
            });
            document.getElementById('totalPrice').textContent = `Total Price: ${totalPrice}원`;
        }
    
        // 수량 증가 함수
        function increaseQuantity() {
            const quantityInput = this.parentElement.querySelector('.quantity-control');
            quantityInput.value = parseInt(quantityInput.value) + 1;
            updateTotalPrice();
        }
    
        // 수량 감소 함수
        function decreaseQuantity() {
            const quantityInput = this.parentElement.querySelector('.quantity-control');
            if (parseInt(quantityInput.value) > 1) {
            quantityInput.value = parseInt(quantityInput.value) - 1;
            updateTotalPrice();
            }
        }
    </script>
</body>
</html>